<%
title t('.page_title', game: @game.title)
%>
<div class="columns is-gapless">
  <div class="column is-full-mobile is-half-tablet is-one-third-desktop is-one-quarter-widescreen is-one-fifth-fullhd">
    <div data-controller="video-chat">
      <ol>
        <% @game.players.each do |player| %>
          <% if player.user == current_user %>
            <li data-target="video-chat.host" data-participant-id="<%= player.id %>">
              <strong><%= current_user.name %></strong>
              <a data-action="click->video-chat#startStreaming">start</a>
              <a data-action="click->video-chat#stopStreaming">stop</a>
              <video autoplay playsinline></video>
              <select data-target="video-chat.devices"
                      data-action="change->video-chat#changeStreamingDevice"
                      style="display: none">
              </select>
            </li>
          <% else %>
            <li data-target="video-chat.participant" data-participant-id="<%= player.id %>" style="display: none">
              <em><%= player.user.name %></em>
              <video autoplay playsinline></video>
            </li>
          <% end %>
        <% end %>
      </ol>
    </div>
  </div>
  
  <div class="column">
    <% if @map && @floor %>
      <%=
        render '/map/displayer', game: @game, map: @map, active_floor: @floor
      %>
    <% end %>
  </div>
</div>
