<%
area ||= local_assigns[:area_panel]
map  ||= area.map

if area.persisted?
  form_url = map_area_path(map, area)
else
  form_url = map_areas_path(map)
end
%>
<nav class="panel" id="<%= dom_id(area, :panel) %>" data-controller="map--panel">
  <div class="panel-heading">
    <%=
      link_to '<', "##{dom_id(area.floor, :panel)}",
        class: 'button is-small is-link is-outlined',
        data: {
          action: 'click->map--panel#openPanel'
        }
    %>
    <%= area.full_title %>
    <%=
      link_to t('.edit'),
        edit_map_area_path(area.map, area),
        class: 'button is-small',
        data: { remote: true }
    %>
  </div>
  <%= bulma_form_for area, url: form_url, html: { class: 'panel-block' } do |f| %>
    <%= f.field :title do %>
      <%= f.label      :title %>
      <%= f.text_field :title %>
      <%= f.errors     :title %>
    <% end %>
    
    <%= f.field :short_code do %>
      <%= f.label      :short_code %>
      <%= f.text_field :short_code %>
      <%= f.errors     :short_code %>
    <% end %>
    
    <%= f.field :floor_id do %>
      <%= f.label  :floor_id %>
      <%= f.select :floor_id, @map.floors.map { |f| [f.title, f.id] } %>
      <%= f.errors :floor_id %>
    <% end %>
    
    <div class="columns">
      <div class="column">
        <%= f.field :x do %>
          <%= f.label        :x %>
          <%= f.number_field :x %>
          <%= f.errors       :x %>
        <% end %>
      </div>
      <div class="column">
        <%= f.field :y do %>
          <%= f.label        :y %>
          <%= f.number_field :y %>
          <%= f.errors       :y %>
        <% end %>
      </div>
    </div>
    
    <%= f.field :bounds_json do %>
      <%= f.label     :bounds_json %>
      <%= f.text_area :bounds_json %>
      <%= f.errors    :bounds_json %>
    <% end %>
    
    <%= f.submit_or_reset %>
  <% end %>
</nav>
